<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="css/styles.css">

</head>


<body>
  <div class="header">Space Wizard Sim</div>
  <div id="wiz" class="cat">
    <img id="catImg" src="Character/SmallWizardR.png" alt="wizard">
  </div>
  <div class="ground"></div>


<script>
    const cat = document.getElementById("wiz");
    const catImg = document.getElementById("catImg");
    let x = 48;
    let y = 45;
    let i = 0;
	let t = 0;
    let jump = false;
    let left = false;
    let right = false;

    const Vvel = 0.12;
    const Hvel = 0.75;
    const gravity = 0.003;
	const xlimL = 3;
	const xlimR = 90;
	const ground = 75;

	// checks mouse position 
	let mouseX = 0;
	
	document.addEventListener("mousemove", function (event) {
	  mouseX = event.clientX;
	}); 

    // Keyboard controls
    document.addEventListener("keydown", function (event) {
      switch (event.key) {
        case " ":
          if (y > 40) {
            i = 0;
			t = 0;
            jump = true;
          }
          break;
        case "a":
          if (x > xlimL) left = true;
          break;
        case "d":
          if (x < xlimR) right = true;
          break;
      }
    });

    document.addEventListener("keyup", function (event) {
      switch (event.key) {
        case "a":
          left = false;
          break;
        case "d":
          right = false;
          break;
      }
    });

    // Movement and gravity
    function move() {
      const catRect = cat.getBoundingClientRect();
      const catCenterX = catRect.left + catRect.width / 2;

      
      if (right && (x < xlimR)) x += Hvel;
      if (left && (x > xlimL)) x -= Hvel;

      if (jump) {
        y += -Vvel * i + gravity * i * i;
        i += 1;

        if ((-Vvel * i + gravity * i * i) >= 0) {
          jump = false;
          i = 0;
        }
      } else {
        if (y < ground && (y + gravity * i * i) < ground) {
          y += gravity * i * i;
          i += 1;
        } else {
		
		// hovering mechanic
		  t += 0.07;
		  y = ground - 4 * (Math.cos(t) - 1) / 2;
          i = 0;
        }
      }
	  
	  //Character direction
	  if (mouseX < catCenterX) {
        catImg.src = "Character/SmallWizardL.png"; // face left
      } else {
        catImg.src = "Character/SmallWizardR.png"; // face right
      }

      cat.style.left = x + "%";
      cat.style.top = y + "%";
      requestAnimationFrame(move);
    }

    move();
  </script>

</body>
</html>

